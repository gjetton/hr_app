<!-- hr_app/templates/hr/timeclock.html -->{% extends 'base.html' %}{% block title %}Timeclock{% endblock %}{% block content %}<h2>Timeclock</h2><p>Status: {{ is_clocked_in|yesno:"Clocked In,Clocked Out" }}</p><form method="post">    {% csrf_token %}    {{ form.as_p }}    <button type="submit" class="btn btn-primary">{{ is_clocked_in|yesno:"Clock Out,Clock In" }}</button></form><!-- Personal Total Hours for Non-Leaders -->{% if not is_leader %}    <h3>Your Total Hours (Since {{ default_start_date }})</h3>    {% for user, total_hours in total_hours_list %}        {% if user.id == request.user.id %}            <p>{{ total_hours|floatformat:2 }} hours</p>        {% endif %}    {% endfor %}{% endif %}{% if is_leader %}    <h3>Crew Members</h3>    {% for data in crew_members_data %}        <div class="card mb-2">            <div class="card-body">                <p>{{ data.member.first_name }} {{ data.member.last_name }} - {{ data.is_clocked_in|yesno:"Clocked In,Clocked Out" }}</p>                {% for user, total_hours in total_hours_list %}                    {% if user.id == data.member.id %}                        <p>Total Hours (Since {{ default_start_date }}): {{ total_hours|floatformat:2 }} hours</p>                    {% endif %}                {% endfor %}                <form method="post">                    {% csrf_token %}                    {{ form.as_p }}                    <input type="hidden" name="employee_id" value="{{ data.member.id }}">                    <button type="submit" class="btn btn-primary">{{ data.is_clocked_in|yesno:"Clock Out,Clock In" }}</button>                </form>            </div>        </div>    {% empty %}        <p>No crew members assigned.</p>    {% endfor %}    <!-- Crew Timeclock Entries section -->    <h3>Crew Timeclock Entries</h3>    <form method="post">        {% csrf_token %}        <input type="hidden" name="save_all" value="1">        <table class="table table-sm table-bordered">            <thead>                <tr>                    <th>Employee</th>                    <th>Clock In</th>                    <th>Clock Out</th>                    <th>Hours</th>                    <th>Hours Type</th>                    <th>Shift</th>                    <th>WC Code</th>                    <th>Task Code</th>                    <th>Job ID</th>                    <th>Phase</th>                    <th>Project No</th>                    <th>Tkt #</th>                    <th>Perdiem</th>                    <th>Location</th>                    <th>Supervisor</th>                    <th>Non Bill</th>                    <th>Invoice #</th>                    <th>Dept</th>                    <th>Notes</th>                    <th>Delete</th>                    <th>Actions</th>                </tr>            </thead>            <tbody>            {% for entry in crew_timeclock_entries %}                <tr>                    <td>{{ entry.user.first_name }} {{ entry.user.last_name }}</td>                    <td><input type="datetime-local" name="clock_in[{{ entry.id }}]" value="{{ entry.clock_in|date:'Y-m-d\TH:i' }}" required style="width: 220px;"></td>                    <td><input type="datetime-local" name="clock_out[{{ entry.id }}]" value="{{ entry.clock_out|date:'Y-m-d\TH:i' }}" {% if not entry.clock_out %}disabled{% endif %} style="width: 220px;"></td>                    <td>{{ entry.hours_worked|default:"N/A" }}</td>                    <td><select name="hours_type[{{ entry.id }}]">                        <option value="regular" {% if entry.hours_type == 'regular' or not entry.hours_type %}selected{% endif %}>Regular</option>                        <option value="ot1" {% if entry.hours_type == 'ot1' %}selected{% endif %}>OT1</option>                        <option value="ot2" {% if entry.hours_type == 'ot2' %}selected{% endif %}>OT2</option>                    </select></td>                    <td><input type="text" name="shift[{{ entry.id }}]" value="{{ entry.shift }}" size="5"></td>                    <td><input type="text" name="wc_code[{{ entry.id }}]" value="{{ entry.wc_code }}" size="2" maxlength="2"></td>                    <td><input type="text" name="task_code[{{ entry.id }}]" value="{{ entry.task_code }}" size="8" maxlength="8"></td>                    <td><input type="text" name="job_id[{{ entry.id }}]" value="{{ entry.job_id }}" size="8" maxlength="8"></td>                    <td><input type="text" name="phase[{{ entry.id }}]" value="{{ entry.phase }}" size="3" maxlength="3"></td>                    <td><input type="text" name="project_no[{{ entry.id }}]" value="{{ entry.project_no }}" size="20" maxlength="20"></td>                    <td><input type="text" name="tkt_no[{{ entry.id }}]" value="{{ entry.tkt_no }}" size="18" maxlength="18"></td>                    <td><input type="text" name="perdiem[{{ entry.id }}]" value="{% if entry.perdiem is not None %}{{ entry.perdiem|floatformat:0 }}{% endif %}" size="3" maxlength="1" class="form-control"></td>                    <td><input type="text" name="location[{{ entry.id }}]" value="{{ entry.location }}" size="15" maxlength="15"></td>                    <td><select name="supervisor[{{ entry.id }}]" class="form-select" style="width: 150px;">                        <option value="">None</option>                        {% for user in users %}                            <option value="{{ user.id }}" {% if entry.supervisor == user %}selected{% endif %}>{{ user.first_name }} {{ user.last_name }}</option>                        {% endfor %}                    </select></td>                    <td><select name="non_bill[{{ entry.id }}]" class="form-select" style="width: 80px;">                        <option value="" {% if entry.non_bill == '' or not entry.non_bill %}selected{% endif %}>No</option>                        <option value="y" {% if entry.non_bill == 'y' %}selected{% endif %}>Yes</option>                    </select></td>                    <td><input type="text" name="invoice_no[{{ entry.id }}]" value="{{ entry.invoice_no }}" size="5"></td>                    <td><input type="text" name="dept[{{ entry.id }}]" value="{{ entry.dept }}" size="2" maxlength="2"></td>                    <td><textarea name="notes[{{ entry.id }}]" rows="1" cols="10">{{ entry.notes }}</textarea></td>                    <td><input type="checkbox" name="delete[{{ entry.id }}]" value="1" class="form-check-input" style="width: 25px; height: 25px; border: 2px solid #dc3545;"></td>                    <td><a href="{% url 'timeclock_report' %}?employee={{ entry.user.id }}" class="btn btn-sm btn-info">View Report</a></td>                </tr>            {% empty %}                <tr><td colspan="21">No timeclock entries found.</td></tr>            {% endfor %}            </tbody>        </table>        <button type="submit" class="btn btn-primary">Save All</button>    </form>{% endif %}<a href="{% url 'home' %}" class="btn btn-secondary">Back</a>{% if user.is_staff %}    <a href="{% url 'manage_crews' %}" class="btn btn-info">Manage Crews</a>    <a href="{% url 'timeclock_report' %}" class="btn btn-info">Timeclock Report</a>{% endif %}{% endblock %}